<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Firebase ID Token Helper</title>
    <style>
      body { font-family: system-ui, sans-serif; max-width: 640px; margin: 40px auto; }
      input { width: 100%; padding: 8px; margin: 8px 0; }
      button { padding: 10px 16px; }
      pre { background: #f5f5f5; padding: 12px; white-space: pre-wrap; }
    </style>
  </head>
  <body>
    <h1>Get Firebase ID Token (Phone Auth)</h1>
    <p>Use a Test phone number and code you configured in Firebase Console.</p>

    <label>Phone number (E.164, e.g. +15555550100)</label>
    <input id="phone" placeholder="+15555550100" />

    <label>Test code (e.g. 123456)</label>
    <input id="code" placeholder="123456" />

    <button id="send">Sign In and Get ID Token</button>

    <h3>ID Token</h3>
    <pre id="out"></pre>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
      import { getAuth, signInWithPhoneNumber, RecaptchaVerifier } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";

      // Replace with your project's Firebase config from Firebase Console
      const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_AUTH_DOMAIN",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_STORAGE_BUCKET",
        messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
        appId: "YOUR_APP_ID",
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);

      // For test phone numbers only; remove/disable for real phones in production
      auth.settings.appVerificationDisabledForTesting = true;

      const phoneInput = document.getElementById('phone');
      const codeInput = document.getElementById('code');
      const out = document.getElementById('out');

      // Invisible reCAPTCHA verifier (still required by the SDK)
      const verifierContainer = document.createElement('div');
      document.body.appendChild(verifierContainer);
      const verifier = new RecaptchaVerifier(auth, verifierContainer, { size: 'invisible' });

      document.getElementById('send').onclick = async () => {
        try {
          const confirmation = await signInWithPhoneNumber(auth, phoneInput.value.trim(), verifier);
          const credential = await confirmation.confirm(codeInput.value.trim());
          const idToken = await credential.user.getIdToken();
          out.textContent = idToken;
        } catch (e) {
          out.textContent = 'Error: ' + (e?.message || e);
        }
      };
    </script>
  </body>
</html>